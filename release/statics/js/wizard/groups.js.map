{"version":3,"sources":["../../../../src/js/wizard/groups.js"],"names":["define","uk","conf","inst","u","extend","newPubSub","fetchGroups","$","ajax","url","BASE","token","method","data","done","arr","d","groups","Groups","forEach","push","name","i","Name","id","ID","groupSucc","emit","fail","x","status","firstGroupFetch","groupFail","init"],"mappings":"AAAAA,OAAO,CAAC,aAAD,EAAgB,YAAhB,CAAP,EAAsC,UAACC,EAAD,EAAKC,IAAL,EAAc;AACnD,KAAMC,OAAOC,EAAEC,MAAF,CAAUC,WAAV,CAAb;;AAEA,UAASC,WAAT,GAAuB;AACtBC,IAAEC,IAAF,CAAO;AACNC,QAAKR,KAAKS,IAAL,GAAY,kBAAZ,GAAiCC,OADhC;AAENC,WAAQ,KAFF;AAGNC,SAAM;AAHA,GAAP,EAKCC,IALD,CAKM,aAAK;AACV,OAAIC,MAAM,EAAV;AACAC,KAAEC,MAAF,CAAS,CAAT,EAAYC,MAAZ,CAAmBC,OAAnB,CAA4B;AAAA,WAAKJ,IAAIK,IAAJ,CAAS,EAACC,MAAMC,EAAEC,IAAT,EAAeC,IAAIF,EAAEG,EAArB,EAAT,CAAL;AAAA,IAA5B;AACAC,aAAUX,GAAV;AACAb,QAAKyB,IAAL,CAAU,gBAAV,EAA4BZ,GAA5B;AACA,GAVD,EAWCa,IAXD,CAWM,aAAK;AACV,OAAIC,EAAEC,MAAF,KAAa,GAAjB,EAAsB;AACrB5B,SAAKyB,IAAL,CAAU,aAAV,EAAyB,CAACI,eAA1B;AACA,IAFD,MAEO;AACNC;AACA;AACD,GAjBD;AAkBA,MAAID,eAAJ,EAAqBA,kBAAkB,KAAlB;AACrB;AACD,UAASE,IAAT,GAAgB,CAEf;;AAED/B,MAAK+B,IAAL,GAAYA,IAAZ;;AAEA,QAAO/B,IAAP;AACA,CA/BD","file":"groups.js","sourcesContent":["define([\"core/config\", \"core/token\"], (uk, conf) => {\r\n\tconst inst = u.extend( newPubSub() );\r\n\t\r\n\tfunction fetchGroups() {\r\n\t\t$.ajax({\r\n\t\t\turl: conf.BASE + \"device/grouptree\" + token(),\r\n\t\t\tmethod: \"GET\",\r\n\t\t\tdata: \"parent_only=true\"\r\n\t\t})\r\n\t\t.done(d => {\r\n\t\t\tlet arr = [];\r\n\t\t\td.groups[0].Groups.forEach( i => arr.push({name: i.Name, id: i.ID}) );\r\n\t\t\tgroupSucc(arr);\r\n\t\t\tinst.emit(\"groups_fetched\", arr);\r\n\t\t})\r\n\t\t.fail(x => {\r\n\t\t\tif (x.status === 403) {\r\n\t\t\t\tinst.emit(\"login_error\", !firstGroupFetch);\r\n\t\t\t} else {\r\n\t\t\t\tgroupFail();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (firstGroupFetch) firstGroupFetch = false;\r\n\t}\r\n\tfunction init() {\r\n\t\t\r\n\t}\r\n\t\r\n\tinst.init = init;\r\n\t\r\n\treturn inst;\r\n});"]}