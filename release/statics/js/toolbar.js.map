{"version":3,"sources":["../../../src/js/toolbar.js"],"names":["define","inst","u","extend","newPubSub","els","autorefOn","gapCount","gapType","DEFAULT_GAP","DEFAULT_MINUTES","DEFAULT_SECONDS","MIN_MINUTES","MAX_MINUTES","MIN_SECONDS","MAX_SECONDS","gap","count","type","parseGapCount","parseInt","val","enableBtns","cancel","attr","disabled","addClass","apply","disableBtns","removeClass","emitStart","emit","emitEnd","init","root","getEls","Switchery","autoref","color","secondaryColor","jackColor","jackSecondaryColor","className","disabledOpacity","speed","size","on","checked","e","target","toDis","add","el","$","value","change","save","deleteAll","minAll","maxAll","shrinkAll","expandAll"],"mappings":"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","file":"toolbar.js","sourcesContent":["define([], () => {\r\n\tconst inst = u.extend( newPubSub() );\r\n\tlet els;\r\n\tlet autorefOn, gapCount, gapType;\r\n\r\n\tconst DEFAULT_GAP = 15000;\r\n\tconst DEFAULT_MINUTES = 2;\r\n\tconst DEFAULT_SECONDS = 15;\r\n\tconst MIN_MINUTES = 1;\r\n\tconst MAX_MINUTES = 5;\r\n\tconst MIN_SECONDS = 15;\r\n\tconst MAX_SECONDS = 300;\r\n\t\r\n\t\r\n\tfunction gap(count, type) {\r\n\t\treturn type === \"s\" ? count * 1000 : type === \"m\" ? count * 60000 : DEFAULT_GAP;\r\n\t}\r\n\tfunction parseGapCount() {\r\n\t\treturn parseInt(els.gapCount.val(), 10);\r\n\t}\r\n\tfunction enableBtns() {\r\n\t\tels.cancel.attr({disabled: false}).addClass(\"danger\");\r\n\t\tels.apply.attr({disabled: false}).addClass(\"success\");\r\n\t}\r\n\tfunction disableBtns() {\r\n\t\tels.cancel.attr({disabled: true}).removeClass(\"danger\");\r\n\t\tels.apply.attr({disabled: true}).removeClass(\"success\");\r\n\t}\r\n\tfunction emitStart() {\r\n\t\tlet count = parseGapCount();\r\n\t\tlet type = els.gapType.val();\r\n\t\tinst.emit( \"start_auto_refresh\", gap(type, count) );\r\n\t}\r\n\tfunction emitEnd() {\r\n\t\tinst.emit(\"end_auto_refresh\");\r\n\t}\r\n\tfunction init(root) {\r\n\t\tels = u.getEls(root);\r\n\t\tgapCount = parseGapCount();\r\n\t\tgapType = els.gapType.val();\r\n\t\t\r\n\t\tnew Switchery(els.autoref[0], {\r\n\t\t\tcolor: \"#64bd63\",\r\n\t\t\tsecondaryColor: \"#dfdfdf\",\r\n\t\t\tjackColor: \"#fff\",\r\n\t\t\tjackSecondaryColor: null,\r\n\t\t\tclassName: \"switchery\",\r\n\t\t\tdisabled: false,\r\n\t\t\tdisabledOpacity: 0.5,\r\n\t\t\tspeed: \"0.2s\",\r\n\t\t\tsize: \"default\"\r\n\t\t});\r\n\t\tels.autoref.on(\"click\", e => {\r\n\t\t\tlet checked = e.target.checked;\r\n\t\t\tlet toDis = els.gapCount.add( els.gapType );\r\n\t\t\tif (checked) {\r\n\t\t\t\tautorefOn = true;\r\n\t\t\t\temitStart();\r\n\t\t\t\ttoDis.attr({disabled: false});\r\n\t\t\t} else {\r\n\t\t\t\tautorefOn = false;\r\n\t\t\t\temitEnd();\r\n\t\t\t\ttoDis.attr({disabled: true});\r\n\t\t\t\tdisableBtns();\r\n\t\t\t}\r\n\t\t});\r\n\t\tels.gapCount.on(\"input keyup change\", e => {\r\n\t\t\tlet el = $(e.target);\r\n\t\t\tlet val = parseInt(el.val(), 10);\r\n\t\t\tlet type = els.gapType.val();\r\n\t\t\tif (type === \"m\") {\r\n\t\t\t\tif (val > MAX_MINUTES) {\r\n\t\t\t\t\tel.val(MAX_MINUTES);\r\n\t\t\t\t} else if (val < MIN_MINUTES) {\r\n\t\t\t\t\tel.val(MIN_MINUTES);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} else if (type === \"s\") {\r\n\t\t\t\tif (val > MAX_SECONDS) {\r\n\t\t\t\t\tel.val(MAX_SECONDS);\r\n\t\t\t\t} else if (val < MIN_SECONDS) {\r\n\t\t\t\t\tel.val(MIN_SECONDS);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif ( gap(gapCount, gapType) !== gap(val, type) ) {\r\n\t\t\t\tenableBtns();\r\n\t\t\t} else {\r\n\t\t\t\tdisableBtns();\r\n\t\t\t}\r\n\t\t});\r\n\t\tels.gapType.on(\"change\", e => {\r\n\t\t\tif (autorefOn) {\r\n\t\t\t\tlet val = e.target.value;\r\n\t\t\t\tlet gapCount = els.gapCount;\r\n\t\t\t\tif (val === \"m\") {\r\n\t\t\t\t\tgapCount.attr(\"min\", MIN_MINUTES).val(DEFAULT_MINUTES);\r\n\t\t\t\t} else if (val === \"s\") {\r\n\t\t\t\t\tgapCount.attr(\"min\", MIN_SECONDS).val(DEFAULT_SECONDS);\r\n\t\t\t\t}\r\n\t\t\t\tgapCount.change();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tels.cancel.on(\"click\", e => {\r\n\t\t\tif (e.target.disabled) return;\r\n\t\t\tdisableBtns();\r\n\t\t});\r\n\t\tels.apply.on(\"click\", e => {\r\n\t\t\tif (e.target.disabled) return; \r\n\t\t\tgapCount = parseGapCount();\r\n\t\t\tgapType = els.gapType.val();\r\n\t\t\temitEnd();\r\n\t\t\temitStart();\r\n\t\t\tdisableBtns();\r\n\t\t});\r\n\t\t\r\n\t\tels.add.on      ( \"click\", () => inst.emit(\"add\")        );\r\n\t\tels.save.on     ( \"click\", () => inst.emit(\"save_all\")   );\r\n\t\tels.deleteAll.on( \"click\", () => inst.emit(\"delete_all\") );\r\n\t\tels.minAll.on   ( \"click\", () => inst.emit(\"min_all\")    );\r\n\t\tels.maxAll.on   ( \"click\", () => inst.emit(\"max_all\")    );\r\n\t\tels.shrinkAll.on( \"click\", () => inst.emit(\"shrink_all\") );\r\n\t\tels.expandAll.on( \"click\", () => inst.emit(\"expand_all\") );\r\n\t}\r\n\t\r\n\tinst.init = init;\r\n\t\r\n\treturn inst;\r\n});"]}